---
- name: install apt packages
  apt:
    name: '{{item}}'
    state: present
    update_cache: yes
  loop:
    - apt-transport-https
    - ca-certificates
    - curl
    - software-properties-common

- name: check if docker is installed
  command: docker --version
  register: docker_valid
  ignore_errors: yes

- name: docker setup
  import_tasks: docker.yml
  when: docker_valid.failed

- name: user setup
  import_tasks: user.yml

- name: firewall setup
  import_tasks: firewall.yml
